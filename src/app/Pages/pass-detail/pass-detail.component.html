<app-inner-header></app-inner-header>
<div class="body-grey">

<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' ,fullScreenBackdrop:true}" ></ngx-loading>

<!-- My Studio Card Detials-Service Section -->
<div class="studio-details">
    <div class="container">

      <app-sub-header></app-sub-header>


      <div class="pb-5">
        <div class="row">
          <div class="col-6 text-left">
            <h4 class="title black-color text-uppercase"> Pass details </h4>
          </div>
          <div class="col-6 text-right mb-3">
            <button type="button" class="btn btn-blue-grad px-2 text-uppercase" (click)="commonservice.back()" >Back </button>
          </div>
        </div><!-- End of H\eading -->
       
        <div class="s-d-appoint-block">
          <div class="row">
              <div class="col-12 col-lg-7 mt-3 mt-lg-0">
                  <div class="home-inner-available border-radius6 box-shadow1 white-bg p-4">
                    <div class="" >
                    <div class="available-card">
                      <div class="available-blue-card p-3 p-sm-4">
                        <div class="row mx-0 ">
                          <div class="pass-logo">
                            <img src="{{passDetail.business_logo}}" class="img-fluid">
                          </div>
                          <div class="flex-fill pr-4 pl-5 passTextwidth">
                            <h5 class="white-color font-14 mb-2 mt-0">{{passDetail.pass_name}}</h5>
                            <!-- <h5 class="white-color font-14 mb-3 mt-0">{{passDetail.pass_type}}</h5> -->
                            <h5 class="white-color font-14 mb-2 mt-0">${{passDetail.amount}} <span class="font-12"> Plus Tax </span></h5>
                          </div>
                        </div>
                        <div class="row mt-2 align-items-end">
                          <div class="col-12 text-left pr-0" *ngIf="(passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 1)  || (passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 0) ">
                            <p class="mb-0 white-color paratitle" *ngIf="passDetail.pass_type_category == 'PunchCard'"> Remaining Classes : {{passDetail.remaining_count}} of {{passDetail.total_count}} </p>
                            <p class="mb-0 white-color paratitle" *ngIf="passDetail.pass_type_category == 'TimeFrame' || passDetail.pass_type_category == 'Other'  || passDetail.pass_type_category == 'Recurring Membership' "> Remaining Days : {{passDetail.remaining_count}} of {{passDetail.total_count}}</p>
                          </div>
                          <div class="col-8 text-left pr-0">  
                            <p class="mb-0 white-color paratitle"> Valid For {{passDetail.pass_validity}}</p>         
                            <p class="mb-0 white-color paratitle" *ngIf="(passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 1)  || (passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 0) "> Start Date : {{passDetail.start_date_utc_new}} </p>

                          </div>
                          <!-- <div class="col-4 text-right pl-0">
                            <div class="paraframe">
                            <p class="mb-0 white-color  paratitle"> {{passDetail.pass_type_name}}</p>
                            <p class="mb-0 white-color paratitle">Pass Id : {{passDetail.booking_pass_id}} </p>
                          </div></div> -->
                        </div>
                      </div>
    
                      <div class="studio-card-select">
                        <i class="fas fa-heart brand-color3 font-22" *ngIf="passDetail.favourite == 0"
                          (click)="addFav(passDetail.pass_id,1)"></i>
                        <i class="fas fa-heart brand-color2 font-22" *ngIf="passDetail.favourite == 1"
                          (click)="addFav(passDetail.pass_id,0)"></i>
    
                      </div>
                    </div>
                    </div><!-- Card-3 -->

                    <div class="row ml-2 mr-2 mt-2 d-block">
                      <h5 class="title black-color text-uppercase">Description </h5>
                        <p> {{passDetail.description}}</p>
                    </div>

                <div class="row product-detail-section-btn px-2 pt-3 pb-1" *ngIf ="(!paynow && passDetail.pass_current_status == 1 && passDetail.is_one_time_purchase == 0)">
                    <div class="col-6" *ngIf="userInfo.role_id == 3">
                      <button (click)="AddCart(passDetail)" class="btn new-blue btn-blue-grad font-w-600 text-uppercase py-3" *ngIf="passDetail.is_cart == 0"> Add to cart </button>
                      <a routerLink="/cart" class="btn new-blue btn-blue-grad font-w-600 text-uppercase mx-0 py-3" *ngIf="passDetail.is_cart == 1"> Go to cart </a>
                    </div>
                    <div class="col-6" *ngIf="userInfo.role_id == 3">
                      <!-- <button type="button" class="btn new-green btn-green-grad w-100 text-uppercase font-18 border-none"> buy now </button> -->
                      <button type="button" (click) ="paynow = true" class="btn new-green btn-green-grad font-w-600 text-uppercase mx-0 py-3"> buy now </button>                
                    </div>
                    <!-- <div class="col-4"></div> -->
                  </div> <!-- End of Button --> 

                  <div class="row product-detail-section-btn px-2 pt-3 pb-1" *ngIf ="(!paynow && passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 1)  || (!paynow && passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 0) ">
                    <div class="col-12">
                      <h5 class="title green-color text-center">Pass Already Purchased </h5>

                      </div>
                    <!-- <div class="col-4"></div> -->
                  </div> <!-- End of Button --> 
                  </div>
                  <!-- end of home-inner-class -->
                </div><!-- End of Available Passes -->

            <div class="col-12 col-lg-5 mt-5 mt-lg-0" >
              <div class="s-d-appoint-block-right border-radius6 box-shadow1 white-bg" >
                <div class="px-3 py-3 text-left light-bg border-t-lr-6">
                  <h5 class="title black-color font-w-100 text-uppercase font-16 mb-0"> payment details </h5>
                </div><!-- top heading -->

                <div class="px-3 pt-4 pb-2 border-bottom">
                  <div class="row mb-2">
                    <div class="col-6 text-left">
                      <p class="black-color font-w-100 font-18"> Price({{PassCount}} Item) </p>
                    </div>
                    <div class="col-6 text-right">
                      <p class="black-color font-w-100 font-18"> $ {{passDetail.amount}} </p>
                    </div>
                  </div>
                  <!-- <div class="row">
                    <div class="col-6 text-left">
                      <p class="black-color font-w-100 font-18"> Tax </p>
                    </div>
                    <div class="col-6 text-right">
                      <p class="black-color font-w-100 font-18"> $ {{passDetail.pass_tax_price}} </p>
                    </div>
                  </div> -->
                  <div class="row">
                    <div class="col-6 text-left">
                      <p class="black-color font-w-100 font-18"> Tax 1 </p>
                    </div>
                    <div class="col-6 text-right">
                      <p class="black-color font-w-100 font-18"> $ {{passDetail.tax1_rate}} </p>
                    </div>
                    <div class="col-6 text-left">
                      <p class="black-color font-w-100 font-18"> Tax 2 </p>
                    </div>
                    <div class="col-6 text-right">
                      <p class="black-color font-w-100 font-18"> $ {{passDetail.tax2_rate}} </p>
                    </div>
                  </div>
                </div><!-- end of Appointment Fees: -->

                <div class="px-3 pt-4 pb-3 border-bottom">
                  <div class="row mb-2">
                    <div class="col-6 text-left">
                      <p class="title black-color font-w-100 font-18 mb-0" *ngIf="passDetail.pass_current_status == 1 && passDetail.is_one_time_purchase == 0"> Amount Payable </p>
                      <p class="title black-color font-w-100 font-18 mb-0" *ngIf="(passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 1) || (passDetail.pass_current_status == 0 && passDetail.is_one_time_purchase == 0)  "> Total Paid </p>
                    </div>
                    <div class="col-6 text-right">
                      <p class="title black-color font-w-100 font-18 mb-0"> $ {{passDetail.pass_total_price}} </p>
                    </div>
                  </div>
                </div><!-- end of Amount Payable -->

                <div class="px-3 py-3 text-center" *ngIf="!paymentval && paynow">
                  <div *ngIf="passDetail.is_recring == 1">
                  
                    <!-- <a href="javascript:void(0)" data-target="#busLocation" data-toggle="modal"  data-backdrop="static" data-keyboard="false" class="d-block  font-18 mb-0"> View Terms & Conditions </a> -->
                    <input type="checkbox" class="mt-2 mb-2" (change)="Terms($event)"> {{policy_detail}}
                  </div>
                  <button  type="button" class="btn btn-blue-grad px-4 w-50 text-uppercase mb-0 mb-md-5 mt-2" (click)="passCheck()"> checkout </button>
                </div><!--  data-toggle="modal" data-target="#clientCheckOut" end of button and view policy -->
              </div>
              <div class="client-buy-process border-radius6 box-shadow1 white-bg mt-2" *ngIf="paymentval">
                <div class="p-3 text-left light-bg border-t-lr-6">
                  <h5 class="title black-color font-w-100 text-uppercase font-16 mb-0"> credit card / debit card </h5>
                </div><!-- top heading -->

                <div class="px-3 pt-4 pb-3 border-bottom">
                  <div class="row mb-2">
                    <div class="col-6 text-left">
                      <p class="title black-color font-w-100 font-18 mb-0"> Amount Payable </p>
                    </div>
                    <div class="col-6 text-right">
                      <p class="title black-color font-w-100 font-18 mb-0"> $ {{passDetail.pass_total_price}} </p>
                    </div>
                  </div>
                </div><!-- end of Amount Payable -->

              
                <div class="client-payment-input border-radius6 box-shadow1 white-bg p-4"> 
        
                  <div class="row">
                    <div class="col-12 mb-3" *ngFor="let cardsave of customerData">
                      <div class="client-card-img white-bg border-radius6 box-shadow1" *ngIf= "cardsave.length != 0">
                        <label class="select-card select-card-img select-card-cvv mb-2"> 
                          <img src="assets/img/visa_card.png" *ngIf="cardsave.card_type== 'visa'" class="img-fluid payment_img">
                          <img src="assets/img/master_card.png" *ngIf="cardsave.card_type== 'mc'" class="img-fluid payment_img">
                         <img src="assets/img/american_express.png" *ngIf="cardsave.card_type== 'am'" class="img-fluid payment_img">
                         <!--   <img src="assets/img/interac" *ngIf="cardsave.card_type== 'mc'" class="img-fluid payment_img">
                          <img src="assets/img/amex.png" *ngIf="cardsave.card_type== 'mc'" class="img-fluid payment_img">
                          <img src="assets/img/discover.png" *ngIf="cardsave.card_type== 'mc'" class="img-fluid payment_img"> -->
  
                          <p class="mb-0 font-12 dark-color mt-2">{{cardsave.number}} </p>
                          <h5 class="mb-0 font-12 dark-color mt-2">Valid Till(MM/YYYY) </h5>
                          <p class="mb-0 font-12 dark-color mt-2">{{cardsave.expiry_month}} / {{cardsave.expiry_year}}</p>
                          <input type="radio" checked="checked" name="radio" [id]="cardsave.card_id" [value]="cardsave.card_id" [(ngModel)]="cardType" [ngModelOptions]="{standalone: true}" (change)="getCardType($event)">
                          <span class="checkmark"></span>
                        </label>
                        
                        <form [formGroup]="savedCard" *ngIf="cardsave.checked == true && cardType == cardsave.card_id" >
                        <div class="text-center d-flex">
                          <!-- <input type="password" name="" placeholder="CVV" class="form-control w-25">  -->
                          <input type="password" autocomplete="off" class="form-control w-25 ml-5" onkeyup="this.value=this.value.replace(/^\s+/g, '')" placeholder="CVV" pattern="\d{3,4}"  onKeyPress="if(this.value.length >=4) return false;" formControlName="cvv_no" [ngClass]="{ 'is-invalid': submitted && sf.cvv_no.errors }">
                          <div *ngIf="submitted && sf.cvv_no.errors" class="invalid-feedback">
                              <div *ngIf="sf.cvv_no.errors.required">CVV is required</div>  
                              <div *ngIf="sf.cvv_no.errors.pattern">CVV is not valid</div> 
                           </div>  
                           <button type="button" class="btn btn-blue-grad px-4 w-50 text-uppercase mb-0 mb-md-3 ml-5" (click)="generateToken(2)"> Pay </button>

                        </div>
                      </form>
                      </div>
                    </div><!-- end of Master Card --> 
                    <div class="col-12 mb-3">
                      <div class="white-bg border-radius6 box-shadow1">
                        <label class="select-card"> New Card
                          <input type="radio" checked="checked" name="radio" id="new" value="new" [(ngModel)]="cardType" [ngModelOptions]="{standalone: true}" (change)="getCardType($event)">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                    </div><!-- end of New Card -->        
                   
                  </div> <!-- end of row -->
          </div>
             
            <form [formGroup]="paymentCard" *ngIf="cardType == 'new'">
               
                  <div class="row py-4 px-3">
                    <div class="col-12 col-sm-6">
                      <div class="form-group">
                        <p class="brand-color3 text-left font-14 mb-2"> Name On Card </p>
                        <input type="text"  class="form-control" autocomplete="off" onkeyup="this.value=this.value.replace(/^\s+/g, '')" placeholder="Sophie Joe" formControlName="card_holder_name" [ngClass]="{ 'is-invalid': submitted && f.card_holder_name.errors }">
                        <div *ngIf="submitted && f.card_holder_name.errors" class="invalid-feedback">
                          <div *ngIf="f.card_holder_name.errors.required">Card Holder Name is required</div> 
                          <div *ngIf="f.card_holder_name.errors.pattern">Card Holder Name is required</div>  
                         </div>
                      </div>
                    </div><!-- First Name -->
  
                    <div class="col-12 col-sm-6">
                      <div class="form-group client-buy-input-cardno">
                        <p class="brand-color3 text-left font-14 mb-2"> Card Number </p>
                        <input type="text"  class="form-control" autocomplete="off" onkeyup="this.value=this.value.replace(/^\s+/g, '')" placeholder="4121 4411 3131 8554" pattern="\d{15,19}" onKeyPress="if(this.value.length >= 19) return false;" formControlName="card_number" [ngClass]="{ 'is-invalid': submitted && f.card_number.errors }">
                        <!-- <img src="assets/img/ic_visacard.png" class="input-visa-img">  -->
                        <div *ngIf="submitted && f.card_number.errors" class="invalid-feedback">
                          <div *ngIf="f.card_number.errors.required">Card Number is required</div>  
                          <div *ngIf="f.card_number.errors.pattern">Card Number is not valid</div>  

                       </div>                   </div>
                    </div><!-- Last Name -->
  
                    <div class="col-12 col-sm-6 mt-2 mt-md-3">
                      <div class="form-group">
                        <p class="brand-color3 text-left font-14 mb-2"> Valid Till </p>
                        <input type="text"  class="form-control" autocomplete="off" placeholder="MM/YYYY" formControlName="expiry"  [ngClass]="{ 'is-invalid': submitted && f.expiry.errors }" minlength="7" maxlength="7" onKeyPress="if(this.value.length == 2) return this.value=this.value.replace(this.value, this.value+'/');"pattern="^\d{2}/\d{4}">
                        <!-- <input type="number"  class="form-control"  placeholder="MM/YYYY" formControlName="expiry" pattern="\d{2}/\d{2}"  onKeyPress="if(this.value.length >=5) return false;" [ngClass]="{ 'is-invalid': submitted && f.expiry.errors }"> -->
                        <div *ngIf="submitted && f.expiry.errors" class="invalid-feedback">
                            <div *ngIf="f.expiry.errors.required">Valid Till is required</div>  
                            <div *ngIf="f.expiry.errors.pattern">Valid Till is like MM/YY</div>  

                         </div>
                      </div>
                    </div><!-- Email -->
  
                    <div class="col-12 col-sm-6 mt-2 mt-md-3">
                      <div class="form-group">
                        <p class="brand-color3 text-left font-14 mb-2"> CVV </p>
                        <input type="password" class="form-control" autocomplete="off" onkeyup="this.value=this.value.replace(/^\s+/g, '')" placeholder="eg. 201" pattern="\d{3,4}"  onKeyPress="if(this.value.length >=4) return false;" formControlName="cvv_no" [ngClass]="{ 'is-invalid': submitted && f.cvv_no.errors }">
                        <div *ngIf="submitted && f.cvv_no.errors" class="invalid-feedback">
                            <div *ngIf="f.cvv_no.errors.required">CVV is required</div>  
                            <div *ngIf="f.cvv_no.errors.pattern">CVV is not valid</div>  

                         </div>
                      </div>
                    </div>
                    <div class="col-12">
                      <input type="checkbox" (change)="Savecard($event)"> Save Card
                    </div>
                  <div class="w-100 py-5 text-center">
                    <button type="button" class="btn btn-blue-grad px-4 w-50 text-uppercase mb-0 mb-md-5" (click)="generateToken(1)"> Pay </button>
                  </div><!-- end of button and view policy -->                                 
                  
                </div>
                </form>
              </div>
            </div><!-- end of col-md-6 -->            
          </div><!-- end of row -->          
        </div><!-- end of s-d-appoint-block -->   
      </div><!-- end of s-d-appoint -->





    </div><!-- end of container -->
  </div>          
<!-- End of My Studio Card Detials-Service Section -->



</div>
<app-inner-footer></app-inner-footer>

<!-- CHECKOUT MODAL POPUP -->
<div class="modal fade" id="clientCheckOut" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body border-radius6 box-shadow1 p-5 white-bg">
        <div class="border-radius6 box-shadow-blue blue-gradient py-5 px-4 text-center">
          <img src="assets/img/logo_white.png" class="img-fluid">
          <h4 class="title white-color text-uppercase my-4 font-w-600"> select checkout <br> option </h4>
          <button data-dismiss="modal"  type="button" class="btn btn-white2 text-uppercase w-100 mb-4" (click)="paymentval = true"> pay now </button>
          <button data-dismiss="modal" type="button" class="btn btn-white2 text-uppercase w-100" (click)="PayAtStudio()" > pay on pick up </button>            
        </div>
      </div>
    </div>
  </div>
</div>
<!-- END OF CHECKOUT MODAL POPUP -->

<!-- CHECKOUT MODAL POPUP -->
<div class="modal fade" id="busLocation" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <button type="button" class="close text-right mr-2" data-dismiss="modal" aria-label="Close" >
        <span aria-hidden="true">&times;</span>
      </button>  
      <div class="modal-body border-radius6 box-shadow1 p-5 light-bg">
        <div class="text-center">
         
          <h4 class="title black-color text-uppercase mt-4"> Terms & Conditions </h4>
        </div>
        <div class="border-radius6 box-shadow-blue blue-gradient p-4 text-center" [innerHtml] ="policy_detail">
         </div>
      </div>
    </div>
  </div>
</div>
<!-- END OF CHECKOUT MODAL POPUP -->
